import{proxy as d,subscribe as w}from"valtio/vanilla";import{Buffer as E}from"buffer";const l=d({selectedChainId:void 0,chains:void 0,standaloneChains:void 0,standaloneUri:void 0,isStandalone:!1,isCustomDesktop:!1,isCustomMobile:!1,isExplorer:!1}),i={state:l,setChains(e){l.chains=e},setStandaloneChains(e){l.standaloneChains=e},setStandaloneUri(e){l.standaloneUri=e},setSelectedChainId(e){l.selectedChainId=e},setIsStandalone(e){l.isStandalone=e},setIsCustomDesktop(e){l.isCustomDesktop=e},setIsCustomMobile(e){l.isCustomMobile=e},setIsExplorer(e){l.isExplorer=e}},p=d({initialized:!1,ethereumClient:void 0}),P={setEthereumClient(e){!p.initialized&&e&&(p.ethereumClient=e,i.setChains(e.chains),p.initialized=!0)},client(){if(p.ethereumClient)return p.ethereumClient;throw new Error("ClientCtrl has no client set")}};function W(){return typeof matchMedia<"u"&&matchMedia("(prefers-color-scheme: dark)").matches}const h=d({theme:W()?"dark":"light",accentColor:"default",enableNetworkView:!0,projectId:void 0,standaloneChains:void 0,enableStandaloneMode:void 0,mobileWallets:void 0,desktopWallets:void 0,walletImages:void 0,chainImages:void 0}),I={state:h,subscribe(e){return w(h,()=>e(h))},setConfig(e){var t,o,n,a;i.setStandaloneChains(e.standaloneChains),i.setIsStandalone(Boolean((t=e.standaloneChains)==null?void 0:t.length)||Boolean(e.enableStandaloneMode)),i.setIsCustomMobile(Boolean((o=e.mobileWallets)==null?void 0:o.length)),i.setIsCustomDesktop(Boolean((n=e.desktopWallets)==null?void 0:n.length)),i.setIsExplorer(Boolean((a=e.projectId)==null?void 0:a.length)),Object.assign(h,e)}},y="https://explorer-api.walletconnect.com";function O(e){const t=Object.fromEntries(Object.entries(e).filter(([o,n])=>typeof n<"u"&&n!==null&&n!=="").map(([o,n])=>[o,n.toString()]));return new URLSearchParams(t).toString()}async function g(e,t){const o=O(t),n=`${y}/v3/wallets?projectId=${e}&${o}`;return(await fetch(n)).json()}function S(e,t){return`${y}/v2/logo/lg/${t}?projectId=${e}`}const r=d({wallets:{listings:[],total:0,page:1},search:{listings:[],total:0,page:1},previewWallets:[],recomendedWallets:[]});function C(){const{projectId:e}=I.state;if(!e)throw new Error("projectId is required to work with explorer api");return e}const $={state:r,async getPreviewWallets(e){const{listings:t}=await g(C(),e);return r.previewWallets=Object.values(t),r.previewWallets},async getRecomendedWallets(){const{listings:e}=await g(C(),{page:1,entries:6});r.recomendedWallets=Object.values(e)},async getPaginatedWallets(e){const{page:t,search:o}=e,{listings:n,total:a}=await g(C(),e),m=Object.values(n),v=o?"search":"wallets";return r[v]={listings:[...r[v].listings,...m],total:a,page:t??1},{listings:m,total:a}},getImageUrl(e){return S(C(),e)},resetSearch(){r.search={listings:[],total:0,page:1}}},s=d({history:["ConnectWallet"],view:"ConnectWallet",data:void 0}),f={state:s,subscribe(e){return w(s,()=>e(s))},push(e,t){e!==s.view&&(s.view=e,t&&(s.data=t),s.history.push(e))},replace(e){s.view=e,s.history=[e]},goBack(){if(s.history.length>1){s.history.pop();const[e]=s.history.slice(-1);s.view=e}}},u=d({open:!1}),N={state:u,subscribe(e){return w(u,()=>e(u))},open(e){var t;const{chains:o}=i.state,{enableNetworkView:n}=I.state;o?.length&&o.length>1&&n?f.replace("SelectNetwork"):f.replace("ConnectWallet"),typeof e?.uri=="string"&&i.setStandaloneUri(e.uri),(t=e?.standaloneChains)!=null&&t.length&&i.setStandaloneChains(e.standaloneChains),u.open=!0},close(){u.open=!1}},c=d({open:!1,message:"",variant:"success"}),B={state:c,subscribe(e){return w(c,()=>e(c))},openToast(e,t){c.open=!0,c.message=e,c.variant=t},closeToast(){c.open=!1}},b="WALLETCONNECT_DEEPLINK_CHOICE",L={isCoinbaseExtension(){return window.coinbaseWalletExtension},isMobile(){return Boolean(window.matchMedia("(pointer:coarse)").matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent))},isEmptyObject(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.getOwnPropertyNames(e).length===0&&Object.getOwnPropertySymbols(e).length===0},formatNativeUrl(e,t,o){const n=e.replaceAll("/","").replaceAll(":","");this.setWalletConnectDeepLink(n,o);const a=encodeURIComponent(t);return`${n}://wc?uri=${a}`},formatUniversalUrl(e,t,o){let n=e;e.endsWith("/")&&(n=e.slice(0,-1)),this.setWalletConnectDeepLink(n,o);const a=encodeURIComponent(t);return`${n}/wc?uri=${a}`},async wait(e){return new Promise(t=>{setTimeout(t,e)})},openHref(e,t="_self"){window.open(e,t,"noreferrer noopener")},setWalletConnectDeepLink(e,t){localStorage.setItem(b,JSON.stringify({href:e,name:t}))},removeWalletConnectDeepLink(){localStorage.removeItem(b)},isNull(e){return e===null}};typeof window<"u"&&(window.Buffer||(window.Buffer=E),window.global||(window.global=window),window.process||(window.process={env:{}}));export{P as ClientCtrl,I as ConfigCtrl,L as CoreHelpers,$ as ExplorerCtrl,N as ModalCtrl,i as OptionsCtrl,f as RouterCtrl,B as ToastCtrl};
//# sourceMappingURL=index.js.map
